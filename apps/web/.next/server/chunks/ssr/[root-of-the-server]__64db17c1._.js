module.exports=[79517,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(75003),e=a.i(50944),f=a.i(20628);function g({children:a,requiredRole:g,redirectTo:h="/login"}){let{data:i,status:j}=(0,d.useSession)(),k=(0,e.useRouter)(),{themeConfig:l}=(0,f.useTheme)(),[m,n]=(0,c.useState)(!1),[o,p]=(0,c.useState)("");return((0,c.useEffect)(()=>{let a=setTimeout(()=>{"loading"===j&&(n(!0),p(`Status: ${j}, Session: ${!!i}, Required Role: ${g}`))},5e3);return()=>clearTimeout(a)},[j,i,g]),(0,c.useEffect)(()=>{if(console.log("AuthGuard Debug:",{status:j,hasSession:!!i,userRole:i?.user?.role,requiredRole:g,redirectTo:h}),"loading"!==j){if(!i){console.log("No session found, redirecting to:",h),k.push(h);return}if(g&&i.user?.role!==g){console.log("Role mismatch:",{userRole:i.user?.role,requiredRole:g}),"ADMIN"===g&&i.user?.role!=="ADMIN"?k.push("/student"):"USER"===g&&i.user?.role==="ADMIN"||k.push("/login");return}}},[i,j,k,g,h]),"loading"===j)?m?(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center",style:{backgroundColor:l.colors.background},children:(0,b.jsxs)("div",{className:"text-center max-w-md mx-auto p-6",children:[(0,b.jsx)("div",{className:"rounded-full h-12 w-12 mx-auto mb-4 flex items-center justify-center",style:{backgroundColor:`${l.colors.warning}20`},children:(0,b.jsx)("svg",{className:"w-6 h-6",style:{color:l.colors.warning},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),(0,b.jsx)("p",{style:{color:l.colors.text,fontFamily:"Inter, system-ui, sans-serif",marginBottom:"16px"},children:"Authentication is taking longer than expected"}),o&&(0,b.jsx)("p",{style:{color:l.colors.textSecondary,fontFamily:"monospace",fontSize:"12px",marginBottom:"16px"},children:o}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("button",{onClick:()=>window.location.reload(),style:{backgroundColor:l.colors.primary,color:"white",padding:"8px 16px",borderRadius:"6px",fontSize:"14px",cursor:"pointer",marginRight:"8px"},children:"Refresh Page"}),(0,b.jsx)("button",{onClick:()=>k.push("/login"),style:{backgroundColor:l.colors.textSecondary,color:"white",padding:"8px 16px",borderRadius:"6px",fontSize:"14px",cursor:"pointer"},children:"Go to Login"})]})]})}):(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center",style:{backgroundColor:l.colors.background},children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 mx-auto mb-4",style:{borderColor:l.colors.primary}}),(0,b.jsx)("p",{style:{color:l.colors.text,fontFamily:"Inter, system-ui, sans-serif"},children:"Verifying access..."}),(0,b.jsxs)("p",{style:{color:l.colors.textSecondary,fontFamily:"Inter, system-ui, sans-serif",fontSize:"12px",marginTop:"8px"},children:["Status: ",j]})]})}):(0,b.jsx)(b.Fragment,{children:a})}a.s(["default",()=>g])},56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},9270,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AppRouterContext},36313,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.HooksClientContext},18341,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.ServerInsertedHtml},484,a=>{"use strict";var b=a.i(72131);function c(){let[a,c]=(0,b.useState)({isMobile:!1,isTablet:!1,isDesktop:!0,screenWidth:1024,screenHeight:768,orientation:"landscape",supportsTouch:!1,supportsHaptic:!1,safeAreaInsets:{top:0,right:0,bottom:0,left:0}});return(0,b.useEffect)(()=>(setTimeout(()=>{let a=()=>{let a=window.innerWidth,b=window.innerHeight,d=getComputedStyle(document.documentElement),e={top:parseInt(d.getPropertyValue("--mobile-safe-area-top")||"0"),right:parseInt(d.getPropertyValue("--mobile-safe-area-right")||"0"),bottom:parseInt(d.getPropertyValue("--mobile-safe-area-bottom")||"0"),left:parseInt(d.getPropertyValue("--mobile-safe-area-left")||"0")};c({isMobile:a<768,isTablet:a>=768&&a<1024,isDesktop:a>=1024,screenWidth:a,screenHeight:b,orientation:a>b?"landscape":"portrait",supportsTouch:"ontouchstart"in window||navigator.maxTouchPoints>0,supportsHaptic:"vibrate"in navigator,safeAreaInsets:e})};a();let b=new ResizeObserver(a);b.observe(document.body);let d=()=>{setTimeout(a,100)};return window.addEventListener("orientationchange",d),window.addEventListener("resize",a),()=>{b.disconnect(),window.removeEventListener("orientationchange",d),window.removeEventListener("resize",a)}},100),()=>{}),[]),a}function d(){let{supportsHaptic:a}=c(),b=(b=10)=>{if(a&&navigator.vibrate)try{navigator.vibrate(b)}catch(a){console.warn("Haptic feedback not supported:",a)}};return{triggerHaptic:b,triggerLightHaptic:()=>b(10),triggerMediumHaptic:()=>b([10,50,10]),triggerHeavyHaptic:()=>b([20,100,20]),triggerSuccessHaptic:()=>b([10,30,10,30,10]),triggerErrorHaptic:()=>b([50,50,50,50,50]),supportsHaptic:a}}a.s(["useHapticFeedback",()=>d,"useMobileOptimizations",()=>c])},79388,a=>{"use strict";var b=a.i(87924),c=a.i(50944),d=a.i(46271);function e({className:a="",fallback:e="/",label:f="Back"}){let g=(0,c.useRouter)();return(0,b.jsxs)(d.motion.button,{onClick:()=>{window.history.length>1?g.back():g.push(e)},className:`flex items-center gap-2 px-4 py-2 rounded-lg bg-white/5 border border-white/10 text-gray-300 hover:text-gray-100 hover:bg-white/10 transition-all duration-300 ${a}`,whileHover:{scale:1.02,x:-2},whileTap:{scale:.95},title:"Go back",children:[(0,b.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),(0,b.jsx)("span",{className:"text-sm font-medium",children:f})]})}a.s(["default",()=>e])},27320,a=>{"use strict";let b={BASE:0,DROPDOWN:10,DROPDOWN_CONTENT:11,STICKY:20,MODAL_BACKDROP:1e3,MODAL:1001,TOOLTIP:1002,NOTIFICATION:1003,MAX:9999};b.BASE,b.DROPDOWN,b.STICKY,b.MODAL_BACKDROP,b.MODAL,b.TOOLTIP,b.NOTIFICATION,b.MAX,a.s(["Z_INDEX",0,b])},90293,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(75003),e=a.i(50944),f=a.i(20628),g=a.i(27320);function h(){let{data:a}=(0,d.useSession)(),h=(0,e.useRouter)(),{themeConfig:i}=(0,f.useTheme)(),[j,k]=(0,c.useState)(!1),[l,m]=(0,c.useState)("bottom"),[n,o]=(0,c.useState)("right"),p=(0,c.useRef)(null);(0,c.useEffect)(()=>{},[]);let q=async()=>{await (0,d.signOut)({redirect:!1}),h.push("/login"),k(!1)};return a?(0,b.jsxs)("div",{className:"relative",ref:p,children:[(0,b.jsxs)("button",{onClick:()=>{if(!j){let a=p.current?.getBoundingClientRect(),b=window.innerHeight;window.innerWidth,a&&(a.bottom+300+20>b?m("top"):m("bottom"),a.left-192<20?o("left"):o("right"))}k(!j)},className:"flex items-center space-x-2 p-2 rounded-lg transition-all duration-300 hover:scale-105",style:{backgroundColor:i.colors.surface,color:i.colors.text,border:`1px solid ${i.colors.border}`},children:[(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-white font-semibold",style:{background:`linear-gradient(135deg, ${i.colors.primary} 0%, ${i.colors.secondary} 100%)`},children:a.user?.name?.charAt(0).toUpperCase()||"U"}),(0,b.jsxs)("div",{className:"text-left",children:[(0,b.jsx)("div",{className:"text-sm font-medium",style:{color:i.colors.text},children:a.user?.name||"User"}),(0,b.jsx)("div",{className:"text-xs",style:{color:i.colors.textSecondary},children:a.user?.role||"User"})]})]}),(0,b.jsx)("svg",{className:`w-4 h-4 transition-transform duration-200 ${j?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M19 9l-7 7-7-7"})})]}),j&&(0,b.jsx)("div",{className:`absolute w-48 rounded-xl shadow-xl border max-h-60 overflow-y-auto backdrop-blur-xl ${"bottom"===l?"top-full mt-2":"bottom-full mb-2"} ${"left"===n?"left-0":"right-0"}`,style:{backgroundColor:`${i.colors.surface}CC`,borderColor:i.colors.border,zIndex:g.Z_INDEX.MAX,backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)"},children:(0,b.jsxs)("div",{className:"p-2",children:[(0,b.jsxs)("button",{onClick:()=>h.push("/settings"),className:"w-full flex items-center space-x-3 px-3 py-2 rounded-lg transition-all duration-200 hover:scale-105 text-left",style:{color:i.colors.text},children:[(0,b.jsxs)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,b.jsx)("circle",{cx:"12",cy:"12",r:"3",stroke:"currentColor",strokeWidth:2.5,fill:"none"}),(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M12 1v6m0 6v6m11-7h-6m-6 0H1"})]}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("div",{className:"text-sm font-medium",children:"Account Settings"}),(0,b.jsx)("div",{className:"text-xs",style:{color:i.colors.textSecondary},children:"Manage your preferences"})]})]}),a.user?.role==="ADMIN"&&(0,b.jsxs)("button",{onClick:()=>h.push("/admin/dashboard"),className:"w-full flex items-center space-x-3 px-3 py-2 rounded-lg transition-all duration-200 hover:scale-105 text-left",style:{color:i.colors.text},children:[(0,b.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("div",{className:"text-sm font-medium",children:"Admin Dashboard"}),(0,b.jsx)("div",{className:"text-xs",style:{color:i.colors.textSecondary},children:"Manage maintenance requests"})]})]}),a.user?.role!=="ADMIN"&&(0,b.jsxs)("button",{onClick:()=>h.push("/student"),className:"w-full flex items-center space-x-3 px-3 py-2 rounded-lg transition-all duration-200 hover:scale-105 text-left",style:{color:i.colors.text},children:[(0,b.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("div",{className:"text-sm font-medium",children:"Request Portal"}),(0,b.jsx)("div",{className:"text-xs",style:{color:i.colors.textSecondary},children:"Submit maintenance requests"})]})]}),(0,b.jsx)("div",{className:"border-t my-1",style:{borderColor:i.colors.border}}),(0,b.jsxs)("button",{onClick:()=>{h.push("/login"),k(!1)},className:"w-full flex items-center space-x-3 px-3 py-2 rounded-lg transition-all duration-200 hover:scale-105 text-left",style:{color:i.colors.text},children:[(0,b.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4"})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("div",{className:"text-sm font-medium",children:"Switch Account"}),(0,b.jsx)("div",{className:"text-xs",style:{color:i.colors.textSecondary},children:"Change user account"})]})]}),(0,b.jsxs)("button",{onClick:()=>{confirm("Are you sure you want to remove your account? This action cannot be undone.")&&q(),k(!1)},className:"w-full flex items-center space-x-3 px-3 py-2 rounded-lg transition-all duration-200 hover:scale-105 text-left",style:{color:i.colors.error},children:[(0,b.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m0-6v6m0-6V3a2 2 0 012-2h6a2 2 0 012 2v6"})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("div",{className:"text-sm font-medium",children:"Remove Account"}),(0,b.jsx)("div",{className:"text-xs",style:{color:i.colors.textSecondary},children:"Delete your account"})]})]}),(0,b.jsx)("div",{className:"border-t my-1",style:{borderColor:i.colors.border}}),(0,b.jsxs)("button",{onClick:q,className:"w-full flex items-center space-x-3 px-3 py-2 rounded-lg transition-all duration-200 hover:scale-105 text-left",style:{color:i.colors.text},children:[(0,b.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M17 16l4-4m0 0l-4 4m4-4H3m4 4v-4m0 0v4"})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("div",{className:"text-sm font-medium",children:"Log Out"}),(0,b.jsx)("div",{className:"text-xs",style:{color:i.colors.textSecondary},children:"Sign out of your account"})]})]})]})})]}):(0,b.jsx)("button",{onClick:()=>h.push("/login"),className:"p-2 rounded-xl transition-all duration-300 hover:scale-105",style:{backgroundColor:i.colors.surface,color:i.colors.text,border:`1px solid ${i.colors.border}`},children:(0,b.jsxs)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,b.jsx)("circle",{cx:"12",cy:"8",r:"3",stroke:"currentColor",strokeWidth:2.5,fill:"none"}),(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M16 19a4 4 0 00-8 0"})]})})}a.s(["default",()=>h])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__64db17c1._.js.map